(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(t,e,n){n("bUC5"),t.exports=n("pyCd")},"2pfx":function(t,e,n){var a=n("9VZU");"string"==typeof a&&(a=[[t.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,r);a.locals&&(t.exports=a.locals)},"9VZU":function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"\n#loading {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(255, 255, 240, .5);\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n}\n.loading {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n}\n.loading-bar {\n    display: inline-block;\n    width: 4px;\n    height: 18px;\n    border-radius: 4px;\n    -webkit-animation: loading 1s ease-in-out infinite;\n            animation: loading 1s ease-in-out infinite;\n}\n.loading-bar:nth-child(1) {\n    background-color: #3498db;\n    -webkit-animation-delay: 0;\n            animation-delay: 0;\n}\n.loading-bar:nth-child(2) {\n    background-color: #c0392b;\n    -webkit-animation-delay: 0.09s;\n            animation-delay: 0.09s;\n}\n.loading-bar:nth-child(3) {\n    background-color: #f1c40f;\n    -webkit-animation-delay: .18s;\n            animation-delay: .18s;\n}\n.loading-bar:nth-child(4) {\n    background-color: #27ae60;\n    -webkit-animation-delay: .27s;\n            animation-delay: .27s;\n}\n@-webkit-keyframes loading {\n0% {\n        -webkit-transform: scale(1);\n                transform: scale(1);\n}\n20% {\n        -webkit-transform: scale(1, 2.2);\n                transform: scale(1, 2.2);\n}\n40% {\n        -webkit-transform: scale(1);\n                transform: scale(1);\n}\n}\n@keyframes loading {\n0% {\n        -webkit-transform: scale(1);\n                transform: scale(1);\n}\n20% {\n        -webkit-transform: scale(1, 2.2);\n                transform: scale(1, 2.2);\n}\n40% {\n        -webkit-transform: scale(1);\n                transform: scale(1);\n}\n}\n",""])},D0Mk:function(t,e,n){"use strict";var a=n("jxTe");n.n(a).a},Dq0l:function(t,e,n){"use strict";var a=n("RNKy");n.n(a).a},EXa1:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"\n#app, #main {\r\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\r\n  -webkit-font-smoothing: antialiased;\r\n  -moz-osx-font-smoothing: grayscale;\r\n  width: 100%!important;\r\n  height: 100%!important;\n}\n#loading-screen {\r\n  display: none;\n}\r\n",""])},F6lD:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".sending[data-v-223ca442] {\n  position: absolute;\n  left: 60px;\n  bottom: 10px;\n  z-index: 9999;\n}",""])},G7x2:function(t,e,n){var a=n("gnhj");"string"==typeof a&&(a=[[t.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,r);a.locals&&(t.exports=a.locals)},RNKy:function(t,e,n){var a=n("mqbg");"string"==typeof a&&(a=[[t.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,r);a.locals&&(t.exports=a.locals)},Wamw:function(t,e,n){"use strict";var a=n("G7x2");n.n(a).a},ZaBn:function(t,e,n){"use strict";var a=n("2pfx");n.n(a).a},bUC5:function(t,e,n){"use strict";n.r(e);var a=n("XuX8"),r=n.n(a),i=n("3LiA"),o=n.n(i),s=n("jE9Z"),c=n("L2JU");function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u={data:function(){return{UserName:"",Password:"",showTips:!1,twoFactor:!1,Code:"",UserID:null,logo:"/images/".concat(window.myprovider,".png")}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){l(t,e,n[e])})}return t}({},Object(c.d)({status:function(t){return t.auth.status}})),methods:{validate:function(){return""!=this.UserName&&""!=this.Password},onSubmit:function(t){var e=this;if(t.preventDefault(),this.validate()){var n=this.UserName,a=this.Password;this.$store.dispatch("auth/login",{UserName:n,Password:a}).then(function(t){e.twoFactor=!0,e.UserID=t.data.id}).catch(function(t){t.response?e.$toasted.global.my_app_error({message:t.response.data.message}):e.$toasted.global.my_app_error({message:"Network Error, please check your internet."})})}else this.$toasted.global.my_app_error({message:"Veuillez entrer vos informations!"})},OnCodeValidate:function(t){var e=this;t.preventDefault(),this.Code?this.$store.dispatch("auth/verifyCode",{Code:this.Code,UserID:this.UserID}).then(function(){e.$router.push("/")}).catch(function(t){t.response?e.$toasted.global.my_app_error({message:t.response.data.message}):e.$toasted.global.my_app_error({message:"Network Error, please check your internet."})}):this.$toasted.global.my_app_error({message:"Enter le code recu par sms"})},logout:function(){var t=this;this.$store.dispatch("auth/logout").then(function(){t.$router.push("/login")})},onDragged:function(t){var e=t.el,n=t.deltaX,a=t.deltaY,r=(t.offsetX,t.offsetY,t.clientX,t.clientY,t.first),i=t.last;if(r)this.isDragging=!0;else if(i)this.isDragging=!1;else{var o=+window.getComputedStyle(e).left.slice(0,-2)||0,s=+window.getComputedStyle(e).top.slice(0,-2)||0;e.style.left=o+n+"px",e.style.top=s+a+"px"}}}},d=(n("Dq0l"),n("KHd+")),m=Object(d.a)(u,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"login"}},[n("div",{staticClass:"row w-75 bg-light rounded"},[n("div",{staticClass:"col-12 col-md-6 bg-dark d-flex justify-content-center align-items-center py-5"},[n("div",{staticClass:"d-flex flex-column text-center pt-2"},[n("img",{staticClass:"mx-auto",attrs:{src:t.logo,width:"192",height:"192"}}),t._v(" "),n("h1",{staticClass:"mt-2 text-white"},[t._v("\n                    Soficom\n                ")])])]),t._v(" "),n("div",{staticClass:"col-12 col-md-6 py-5"},[t._m(0),t._v(" "),t.twoFactor?n("form",{ref:"codeForm mt-5",staticClass:"ticketsForm",on:{submit:function(e){return e.preventDefault(),t.OnCodeValidate(e)}}},[n("div",[n("label",{attrs:{for:"code"}},[t._v("Entrez le code")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.Code,expression:"Code"}],staticClass:"k-textbox",attrs:{type:"text",id:"code",name:"text"},domProps:{value:t.Code},on:{input:function(e){e.target.composing||(t.Code=e.target.value)}}})]),t._v(" "),n("div",["loading"!==t.status?n("button",{staticClass:"btn btn-dark",attrs:{type:"submit"}},[n("i",{staticClass:"fa fa-sign-in-alt"}),t._v(" Verifier\n                    ")]):n("p",{staticStyle:{color:"green"}},[n("span",{staticClass:"k-icon k-i-reload"}),t._v(" Verification\n                    ")])])]):n("form",{ref:"myForm",staticClass:"ticketsForm",on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[n("div",[n("label",{attrs:{for:"identification"}},[t._v("Identifiant")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.UserName,expression:"UserName"}],staticClass:"k-textbox",attrs:{type:"text",id:"identification",name:"text"},domProps:{value:t.UserName},on:{input:function(e){e.target.composing||(t.UserName=e.target.value)}}})]),t._v(" "),n("div",[n("label",{attrs:{for:"identification"}},[t._v("Mot de passe")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.Password,expression:"Password"}],staticClass:"k-textbox",attrs:{type:"password",id:"password",name:"password"},domProps:{value:t.Password},on:{input:function(e){e.target.composing||(t.Password=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"licence"},[t._v("\n                    En cliquant sur Connexion, vous acceptez notre \n                    "),n("a",{attrs:{href:"#"}},[t._v("accord de licence.")]),t._v(" "),n("br"),t._v(" "),n("br"),t._v(" "),n("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.showTips=!0}}},[t._v("J'ai oublié mon identifiant ou mon mot de passe.")])]),t._v(" "),n("div",["loading"!==t.status?n("button",{staticClass:"btn btn-dark",attrs:{type:"submit"}},[n("i",{staticClass:"fa fa-sign-in-alt"}),t._v(" Connexion\n                    ")]):n("p",{staticStyle:{color:"green"}},[n("span",{staticClass:"k-icon k-i-reload"}),t._v(" Verification\n                    ")])])])])]),t._v(" "),t.showTips?n("div",{directives:[{name:"dragged",rawName:"v-dragged",value:t.onDragged,expression:"onDragged"}],staticClass:"tips"},[n("div",{staticClass:"card text-white bg-danger mb-3 w-100 h-100",staticStyle:{"max-width":"18rem"}},[t._m(1),t._v(" "),t._m(2),t._v(" "),n("div",{staticClass:"card-footer text-right"},[n("button",{staticClass:"btn btn-default btn-sm text-light",on:{click:function(e){t.showTips=!1}}},[t._v("Fermer")])])])]):t._e()])},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("h1",[this._v("Connexion")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header"},[e("i",{staticClass:"fa fa-question-circle"}),this._v(" Aide")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-body"},[n("p",[t._v("Pour des mesures de securiter veuillez contacter ces numeros:")]),t._v(" "),n("table",{staticClass:"table table-striped table-borderless table-hover table-sm"},[n("tbody",[n("tr",[n("td",[t._v("Tel 1")]),t._v(" "),n("td",[t._v("0817300081")])]),t._v(" "),n("tr",[n("td",[t._v("Tel 2")]),t._v(" "),n("td",[t._v("0818303419")])]),t._v(" "),n("tr",[n("td",[t._v("Tel 3")]),t._v(" "),n("td",[t._v("0818303447")])])])])])}],!1,null,"f9dfd950",null).exports,f=n("UTJ8"),p=n.n(f);function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){v(t,e,n[e])})}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g={components:{SidebarMenu:n("R3Y3").SidebarMenu},data:function(){return{showTips:!1,collapsed:!0,menuConstructor:[{header:!0,title:"Main Navigation"},{title:"Transactions",icon:"fa fa-money-bill-alt",child:[{href:"/transactions/usd",title:"USD"},{href:"/transactions/fc",title:"FC"}]},{title:"SMS",icon:"fa fa-envelope",href:"/sms",simpleAdmin:!0},{title:"Phone Type",icon:"fa fa-phone",href:"/phone_types",superAdmin:!0},{title:"USSD Config",icon:"fab fa-slack-hash",child:[{title:"USD",action:"usd-config"},{title:"FC",action:"fc-config"}],simpleAdmin:!0},{href:"/users",title:"Utilisateurs",icon:"fa fa-user",superAdmin:!0},{title:"Deconnexion",icon:"fa fa-sign-out-alt",action:"logout"},{title:"Charger des données",icon:"fa fa-download",action:"fetch"},{title:"Refresh Application",icon:"fa fa-sync-alt",action:"refresh"},{title:"Aide",icon:"fa fa-question-circle",action:"showTips"}],showConfig:!1,currencyConfig:"usd",port:localStorage.getItem("port")}},created:function(){this.admin>0&&r.a.use(new p.a({debug:!1,connection:"http://localhost:5500"}))},computed:h({},Object(c.d)({admin:function(t){return t.auth.Admin},Company:function(t){return t.auth.Company},UserName:function(t){return t.auth.UserName},dataStatus:function(t){return t.data.status}}),{menu:function(){var t=this;return this.menuConstructor.filter(function(e){return e.superAdmin?!!t.isSuperAdmin:!e.simpleAdmin||!(!t.isSuperAdmin&&!t.isSimpleAdmin)})}},Object(c.c)({isSimpleAdmin:"auth/isSimpleAdmin",isSuperAdmin:"auth/isSuperAdmin"})),watch:{dataStatus:function(t){"loading"===t&&this.$toasted.show("&nbsp; Chargement...",{iconPack:"custom-class",icon:"fa fa-spinner fa-spin",position:"bottom-center"})}},mounted:function(){this.menuConstructor[0].title="".concat(this.Company," (").concat(this.UserName,")"),this.addKeyHandler(),this.fetchData()},sockets:{connect:function(){console.log("socket connected"),this.port&&this.$socket.emit("port",{port:this.port})},newSms:function(t){var e=t.data;window.writeData("sms",h({},e,{read:!1,database:!1})),this.$toasted.info("New message from ".concat(e.number),{action:{text:"Close",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"})},portSet:function(t){"ERROR"==t.status&&(this.port=!1)}},methods:h({},Object(c.b)({loadData:"data/loadData"}),{onCollapse:function(t){this.collapsed=t},onItemClick:function(t,e){switch(e.action){case"logout":confirm("Voulez-vous vous deconnecter ?")&&this.$store.dispatch("auth/logout");break;case"showTips":this.showTips=!this.showTips;break;case"refresh":location.reload();break;case"fetch":this.fetchData();break;case"usd-config":this.ussdConfig("usd");break;case"fc-config":this.ussdConfig("fc")}},addKeyHandler:function(t){window.addEventListener("keydown",this.keyHandler)},removeKeyHandler:function(){window.removeEventListener("keydown",this.keyHandler)},keyHandler:function(t){var e=t.which||t.keyCode;81===e&&t.ctrlKey&&(this.collapsed=!this.collapsed),73===e&&t.ctrlKey&&(this.showTips=!this.showTips)},onDragged:function(t){var e=t.el,n=t.deltaX,a=t.deltaY,r=(t.offsetX,t.offsetY,t.clientX,t.clientY,t.first),i=t.last;if(r)this.isDragging=!0;else if(i)this.isDragging=!1;else{var o=+window.getComputedStyle(e).left.slice(0,-2)||0,s=+window.getComputedStyle(e).top.slice(0,-2)||0;e.style.left=o+n+"px",e.style.top=s+a+"px"}},onDraggedConfigUssd:function(t){var e=t.el,n=t.deltaX,a=t.deltaY,r=(t.offsetX,t.offsetY,t.clientX,t.clientY,t.first),i=t.last;if(r)this.isDragging=!0;else if(i)this.isDragging=!1;else{var o=+window.getComputedStyle(e).left.slice(0,-2)||0,s=+window.getComputedStyle(e).top.slice(0,-2)||0;e.style.left=o+n+"px",e.style.top=s+a+"px"}},fetchData:function(){var t=this;this.loadData().then(function(e){t.$toasted.clear()}).catch(function(e){t.errorDisplay(e.response)})},errorDisplay:function(t){t?this.$toasted.global.my_app_error({message:"".concat(t.data.message," (status: ").concat(t.status,")")}):this.$toasted.global.my_app_error({message:"Erreur réseau, veuillez vérifier votre connexion internet!"})},ussdConfig:function(t){this.currencyConfig=t,this.showConfig=!0}}),destroyed:function(){this.removeKeyHandler()}},b=(n("Wamw"),Object(d.a)(g,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"my-layout",class:{menuclosed:t.collapsed}},[n("sidebar-menu",{attrs:{menu:t.menu,collapsed:t.collapsed,width:"300px"},on:{collapse:t.onCollapse,itemClick:t.onItemClick}}),t._v(" "),t.showTips?n("div",{directives:[{name:"dragged",rawName:"v-dragged",value:t.onDragged,expression:"onDragged"}],staticClass:"tips"},[n("div",{staticClass:"card bg-danger mb-3 w-100 h-100",staticStyle:{"max-width":"18rem"}},[t._m(0),t._v(" "),t._m(1),t._v(" "),n("div",{staticClass:"card-footer text-right"},[n("button",{staticClass:"btn btn-default btn-sm text-light",on:{click:function(e){t.showTips=!1}}},[t._v("Fermer")])])])]):t._e(),t._v(" "),n("router-view"),t._v(" "),t.showConfig?n("div",{directives:[{name:"dragged",rawName:"v-dragged",value:t.onDraggedConfigUssd,expression:"onDraggedConfigUssd"}],staticClass:"config"},[n("ussd-config",{attrs:{currency:t.currencyConfig}}),t._v(" "),n("div",{staticClass:"text-right"},[n("button",{staticClass:"btn btn-sm btn-warning mr-3",on:{click:function(e){t.showConfig=!1}}},[t._v("Fermer")])])],1):t._e(),t._v(" "),!t.port&&t.isSimpleAdmin?n("div",{staticClass:"port-warning p-3 card bg-danger text-white"},[t._v("Port is not set or Invalid, please set the port and refresh the app ")]):t._e()],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header text-white"},[e("i",{staticClass:"fa fa-question-circle"}),this._v(" Aide (App Version 1.0)\n      ")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-body"},[n("table",{staticClass:"table table-striped table-borderless table-hover table-sm text-white"},[n("tbody",[n("tr",[n("td",[t._v("Menu")]),t._v(" "),n("td",[t._v("Ctrl + Q")])]),t._v(" "),n("tr",[n("td",[t._v("Save")]),t._v(" "),n("td",[t._v("Ctrl + Enter")])]),t._v(" "),n("tr",[n("td",[t._v("Ajouter")]),t._v(" "),n("td",[t._v("Ctrl + Space")])]),t._v(" "),n("tr",[n("td",[t._v("Aide")]),t._v(" "),n("td",[t._v("Ctrl + I")])])])])])}],!1,null,"0bfbed29",null).exports),y=n("o0o1"),w=n.n(y),I=function(t){if(t){var e="Voulez-vous partir sans enregistrer ?";window.onbeforeunload=function(t){var n=n||window.event;return n&&(n.returnValue=e),e}}else window.onbeforeunload=null},C=n("pabA");function S(t,e){return t==e||""==t&&""==e||null==t&&null==e||null==t&&""==e||""==t&&null==e}var x=function(t,e){var n=S(t.TransactionID,e.TransactionID),a=S(t.CompanyFID,e.CompanyFID),r=S(t.MVNumber,e.MVNumber),i=S(t.Type,e.Type),o=S(t.MVAmount,e.MVAmount),s=S(t.MVCurrencyFID,e.MVCurrencyFID),c=S(t.MVNotes,e.MVNotes),l=S(t.MVDate,e.MVDate),u=S(t.USSDResponse,e.USSDResponse),d=S(t.Sent,e.Sent);return n&&a&&r&&o&&s&&c&&l&&u&&d&&i},D=new r.a;function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){_(t,e,n[e])})}return t}function _(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var T=function(t,e){t.edited?e.classList.add("table-warning"):e.classList.remove("table-warning"),t.new?e.classList.add("table-success"):e.classList.remove("table-success"),t.deleted?e.classList.add("table-danger"):e.classList.remove("table-danger")},N=(r.a.component("dropdownemployes-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="!dataItem.inEdit" :class="className">{{ dataItem[field] }}</td>\n                <td v-else>\n                  <select @change="change" v-model="value" class="form-control form-control-sm">\n                    <option v-for="employe in employes" :value="employe.EmployeID">\n                      {{ employe.Nom }}\n                    </option>\n                  </select>\n                </td>',data:function(){return{value:""}},mounted:function(){this.value=this.dataItem.EmployeFID},methods:{change:function(t){var e=this;this.$nextTick(function(){e.$emit("change",t,e.selectedEmploye())})},selectedEmploye:function(){var t=this.value,e=this.employes.slice(),n=e.findIndex(function(e){return e.EmployeID==t});return{value:e[n].Nom,foreignKey:"EmployeFID",foreignKeyValue:e[n].EmployeID}}},computed:k({},Object(c.d)({employes:function(t){return t.employes.employes}}))}),r.a.component("dropdowntypes-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="!dataItem.inEdit" :class="className">{{ dataItem[field] }}</td>\n                <td v-else>\n                  <select @change="change" v-model="value" class="form-control form-control-sm">\n                    <option v-for="type in types" :value="type.AbsenceTypeID">\n                      {{ type.AbsenceType }}\n                    </option>\n                  </select>\n                </td>',data:function(){return{value:""}},mounted:function(){this.value=this.dataItem.TypeAbsenceFID},methods:{change:function(t){var e=this;this.$nextTick(function(){e.$emit("change",t,e.selectedType())})},selectedType:function(){var t=this.value,e=this.types.slice(),n=e.findIndex(function(e){return e.AbsenceTypeID==t});return{value:e[n].AbsenceType,foreignKey:"TypeAbsenceFID",foreignKeyValue:e[n].AbsenceTypeID,Transport:e[n].Transport,Salaire:e[n].Salaire}},print:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){print()})},computed:k({},Object(c.d)({types:function(t){return t.types.types}}))}),r.a.component("nb-days-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="!dataItem.inEdit" :class="className">{{ dataItem[field] }}</td>\n                <td v-else>\n                  <input @change="change" type="number" min="1" max="6" :value="dataItem[field] ? dataItem[field] : 1" class="form-control form-control-sm">\n                </td>',methods:{change:function(t){t.target.value=t.target.value<1?1:t.target.value,t.target.value=t.target.value>6?6:t.target.value,this.$emit("change",t,t.target.value)}}}),r.a.component("date-input-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="!dataItem.inEdit" :class="className">{{ dataItem[field] }}</td>\n              <td v-else>\n              {{ dataItem[field] }}\n                <input @change="change" type="date" :value="dataItem[field]"  class="form-control form-control-sm">\n              </td>',methods:{change:function(t){this.$emit("change",t,t.target.value)}}}),r.a.component("template-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:' <td>\n                    <button\n                        @keyup.tab="tab"\n                        class="btn btn-danger btn-sm"\n                        :class="classObject"\n                        @click="removeHandler">\n                        <i class="fa fa-trash-alt"></i>\n                    </button>\n                    </td>',computed:k({},Object(c.d)({absences:function(t){return t.absences.absences},currentWeek:function(t){return t.weeks.current}}),{classObject:function(){return{disabled:!!this.currentWeek&&this.currentWeek.WeekID!=this.dataItem.WeekFID}}}),watch:{dataItem:{handler:function(t,e){T(this.dataItem,this.$parent.$parent.$el)},deep:!0}},methods:{removeHandler:function(){this.$emit("remove",this.dataItem)},tab:function(){D.$emit("tab-pressed",this.dataItem)}}}),r.a.component("has-signature-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td :class="className">\n                <span v-if="dataItem[field]" class="badge badge-success">Yes</span>\n                <span v-else class="badge badge-danger">No</span>\n            </td>'})),O=(r.a.component("bool-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td :class="className">\n                <span v-if="dataItem[field] == 1" class="badge badge-success">Yes</span>\n                <span v-else class="badge badge-danger">No</span>\n            </td>'}),r.a.component("template-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:' <td>\n                  <button\n                      class="btn btn-dark btn-sm"\n                      @click="sign">\n                      <i class="fa fa-file-signature"></i>\n                  </button>\n              </td>',watch:{dataItem:{handler:function(t,e){T(this.dataItem,this.$parent.$parent.$el)},deep:!0}},methods:{sign:function(){D.$emit("start-sign",this.dataItem)}}}),r.a.component("template-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:' <td>\n                  <button\n                      class="btn btn-dark btn-sm"\n                      @click="sign">\n                      <i class="fa fa-file-signature"></i>\n                  </button>\n              </td>',watch:{dataItem:{handler:function(t,e){T(this.dataItem,this.$parent.$parent.$el)},deep:!0}},methods:{sign:function(){D.$emit("start-sign",this.dataItem)}}}),r.a.component("dropdowncompanies-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="!dataItem.inEdit" :class="className">{{ dataItem[field] }}</td>\n              <td v-else>\n                <select @change="change" v-model="value" class="form-control form-control-sm">\n                  <option v-for="company in companies" :value="company.CompanyID" :selected="!Admin">\n                    {{ company.CompanyName }}\n                  </option>\n                </select>\n              </td>',data:function(){return{value:""}},mounted:function(){this.value=this.dataItem.CompanyFID},methods:{change:function(t){var e=this;this.$nextTick(function(){e.$emit("change",t,e.selectedCompany())})},selectedCompany:function(){var t=this.value,e=this.companies.slice(),n=e.findIndex(function(e){return e.CompanyID==t});return{value:e[n].CompanyName,foreignKey:"CompanyFID",foreignKeyValue:e[n].CompanyID}}},computed:k({},Object(c.d)({companies:function(t){return t.companies.companies},Admin:function(t){return t.auth.Admin}}))})),P=r.a.component("companiescommandcell-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:' <td>\n                  <button\n                      @keyup.tab="tab"\n                      class="btn btn-danger btn-sm"\n                      @click="removeHandler">\n                      <i class="fa fa-trash-alt"></i>\n                  </button>\n                  </td>',watch:{dataItem:{handler:function(t,e){T(this.dataItem,this.$parent.$parent.$el)},deep:!0}},methods:{removeHandler:function(){this.$emit("remove",this.dataItem)},tab:function(){D.$emit("tab-pressed",this.dataItem)}}}),j=r.a.component("orange-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:' <td>\n                  <button\n                    v-if="isSimpleAdmin"\n                      class="btn btn-success btn-sm"\n                      @click="ussdHandler"\n\t\t\t\t\t  :disabled="dataItem[\'Sent\'] == 1">\n                      <i v-if="ussdLoading" class="fa fa-spinner fa-spin"></i>\n                      <i v-if="!ussdLoading" class="fa fa-phone-square"></i>\n\t\t\t\t\t  \n                  </button>\n                  <button\n\t\t\t\t\t\t:disabled="dataItem[\'Sent\'] == 1"\n                      @keyup.tab="tab"\n                      class="btn btn-danger btn-sm"\n                      @click="removeHandler">\n                      <i class="fa fa-trash-alt"></i>\n                  </button>\n                  </td>',watch:{dataItem:{handler:function(t,e){T(this.dataItem,this.$parent.$parent.$el)},deep:!0}},data:function(){return{ussdLoading:!1}},computed:k({},Object(c.c)({isSimpleAdmin:"auth/isSimpleAdmin"})),methods:{removeHandler:function(){this.$emit("remove",this.dataItem)},ussdHandler:function(){D.$emit("ussd",this.dataItem)},tab:function(){D.$emit("tab-pressed",this.dataItem)}}}),A=r.a.component("ussd-response-cell-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td :class="className" @click="showValue">{{ dataItem[field] }}</td>',methods:{showValue:function(){this.$dialog.alert(this.dataItem[this.field],{backdropClose:!0})}}}),$=(r.a.component("mv-type-cell-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td :class="className" >{{ dataItem[field] }}</td>'}),r.a.component("my-number-cell-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="!dataItem.inEdit"  class="" > {{ this.formatNumber }}<span @click="copy" class="float-right " ><i class="fa fa-copy" /></span> </td>\n                \n              <td v-else>\n                <input @change="change"  type="number" class="k-textbox" :value="dataItem[field] ? dataItem[field] : 0" style="width:100%;height:100%;"/>\n              </td>',computed:{formatNumber:function(){return new Intl.NumberFormat("en-US").format(this.dataItem[this.field])}},methods:{change:function(t){this.$emit("change",t,t.target.value)},copy:function(){this.$toasted.success("Amount copied",{duration:500,position:"bottom-center"}),navigator.clipboard.writeText(this.dataItem[this.field])},amountClick:function(t){this.dataItem.inEdit||navigator.clipboard.writeText(this.dataItem.MVAmount)}}})),U=r.a.component("my-number-cell-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="!dataItem.inEdit" > \n                {{dataItem[field]}} \n                <span @click="copy" class="float-right"  ><i class="fa fa-copy" /></span>\n              </td>\n              <td v-else>\n                <input @change="change"  type="text" class="k-textbox" :value="dataItem[field]" style="width:100%;height:100%;"/>\n              </td>',computed:{formatNumber:function(){return new Intl.NumberFormat("en-US").format(this.dataItem[this.field])}},methods:{change:function(t){this.$emit("change",t,t.target.value)},copy:function(){this.$toasted.success("Number copied",{duration:500,position:"bottom-center"}),navigator.clipboard.writeText(this.dataItem[this.field])},clickCell:function(t){this.$emit("clickCellPhone",t,t.target.value)}}}),E=(r.a.component("my-number-cell-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="!dataItem.inEdit" > \n                {{dataItem[field]}}\n              </td>\n              \n              <td v-else>\n                <input @change="change"  type="text" class="k-textbox" :value="dataItem[field]" style="width:100%;height:100%;"/>\n              </td>',computed:{formatNumber:function(){return new Intl.NumberFormat("en-US").format(this.dataItem[this.field])}},methods:{change:function(t){this.$emit("change",t,t.target.value)},copy:function(){this.$toasted.success("Number copied",{duration:500,position:"bottom-center"}),navigator.clipboard.writeText(this.dataItem[this.field])},clickCell:function(t){this.$emit("clickCellPhone",t,t.target.value)}}}),r.a.component("my-boolean-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="isSimpleAdmin && dataItem.inEdit">\n\t\t\t\t<select @change="change" v-model="value" class="form-control form-control-sm">\n                  <option :value="0">false</option>\n\t\t\t\t  <option :value="1">true</option>\n                </select>\n\t\t\t</td>\n\t\t\t<td v-else :class="className">\n                <span v-if="dataItem[field] == 1" class="badge badge-success" v-on:dblclick="setFalse">Yes</span>\n                <span v-else class="badge badge-danger">No</span>\n            </td>',data:function(){return{value:0}},computed:k({},Object(c.c)({isSimpleAdmin:"auth/isSimpleAdmin"})),mounted:function(){this.value=this.dataItem[this.field]},methods:{change:function(t){this.$emit("change",t,this.value)},setFalse:function(){this.isSimpleAdmin&&D.$emit("set-false",this.dataItem)}}})),F=r.a.component("my-phone-type-component",{props:{field:String,dataItem:Object,format:String,className:String,columnIndex:Number,columnsCount:Number,rowType:String,level:Number,expanded:Boolean,editor:String},template:'<td v-if="isSimpleAdmin && dataItem.inEdit">\n      <select @change="change" v-model="dataItem[field]" class="form-control form-control-sm">\n      <option value="Agent">Agent</option>\n      <option value="Dealer">Dealer</option>\n    </select>\n\t\t\t</td>\n\t\t\t<td v-else :class="className">\n                <span >{{ dataItem[field]}}</span>\n            </td>',data:function(){return{value:0}},computed:k({},Object(c.c)({isSimpleAdmin:"auth/isSimpleAdmin"})),mounted:function(){this.value=this.dataItem[this.field]},methods:{change:function(t){this.$emit("change",t,this.dataItem[this.field])},setFalse:function(){this.isSimpleAdmin&&D.$emit("set-false",this.dataItem)}}});function V(t,e,n,a,r,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,r)}function R(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var i=t.apply(e,n);function o(t){V(i,a,r,o,s,"next",t)}function s(t){V(i,a,r,o,s,"throw",t)}o(void 0)})}}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){B(t,e,n[e])})}return t}function B(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var H={data:function(){return{loading:!1,items:[],editID:null,columns:[{field:"UserName",title:"Nom",filterable:!0},{field:"Password",title:"Password"},{field:"Company",title:"Branch",filterable:!0,cell:O},{field:"Admin",title:"Admin",filterable:!0},{title:"Del",filterable:!1,cell:P,width:"60px",locked:!0}],filter:{logic:"and",filters:[]},sort:[],nextId:1e6}},mounted:function(){this.loadItems(!0),this.addKeyHandler()},computed:M({usersList:function(){var t=this;return this.items.map(function(e){return Object.assign({inEdit:e.UserID===t.editID},e)})},getData:function(){return Object(C.b)(Object(C.a)(this.usersList,this.filter),this.sort)}},Object(c.d)({users:function(t){return t.users.users},UserName:function(t){return t.auth.UserName},Company:function(t){return t.auth.Company}}),{waitingForSave:function(){var t=0;return this.items.forEach(function(e){(e.edited||e.deleted||e.new)&&t++}),I(t),t}}),methods:M({},Object(c.b)({getUsers:"users/getUsers"}),{refreshData:function(){this.loadItems()},loadItemsFromState:function(){this.items=this.users.map(function(t){return Object.assign({new:!1,edited:!1,deleted:!1},t)}),this.loading=!1,this.editID=null},loadItems:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0,e?this.loadItemsFromState():this.getUsers().then(function(e){t.loadItemsFromState()}).catch(function(e){var n=e.response;n?t.$toasted.global.my_app_error({message:"".concat(n.data.message," (status: ").concat(n.status,")")}):t.$toasted.global.my_app_error({message:"Erreur réseau, veuillez vérifier votre connexion internet!"}),t.loading=!1})},itemChange:function(t){var e=t.field,n=t.value,a=this.items.slice(),r=a.findIndex(function(e){return e.UserID===t.dataItem.UserID});if(["Company"].includes(e)){var i,o=n.foreignKey,s=n.foreignKeyValue,c=n.value;a[r]=M({},a[r],(B(i={},e,c),B(i,o,s),i))}else a[r]=M({},a[r],B({},e,n));var l=this.users.slice(),u=l.findIndex(function(e){return e.UserID===t.dataItem.UserID});a[r].new||(!function(t,e){var n=S(t.UserID,e.UserID),a=S(t.UserName,e.UserName),r=S(t.Password,e.Password),i=S(t.CompanyFID,e.CompanyFID),o=S(t.Admin,e.Admin);return n&&a&&r&&i&&o}(a[r],l[u])?a[r].edited=!0:a[r].edited=!1),this.items=a,this.$set(t.dataItem,e,n)},rowClick:function(t){var e=this;if(this.editID){var n=this.items.slice().find(function(t){return t.UserID==e.editID});if(!this.validateRow(n))return void this.alert()}t.dataItem.deleted||(this.editID=t.dataItem.UserID,this.$set(t.dataItem,"inEdit",!0),this.$nextTick(function(){t.event.path[1].firstChild.firstChild.focus()}))},closeEdit:function(t){t.target===t.currentTarget&&(this.editID=null)},nextRow:function(t){var e=this,n=this.items.slice();if(this.editID){var a=n.find(function(t){return t.UserID==e.editID});if(!this.validateRow(a))return void this.alert()}var r=n.findIndex(function(e){return e.UserID==t.UserID});this.editID=null,r++,n.length===r||this.$nextTick(function(){n[r].deleted||!n[r].new&&n[r].WeekFID!=e.currentWeek.WeekID||(e.editID=n[r].UserID)})},addRecord:function(t){this.nextId++;var e={UserID:this.nextId,new:!0},n=this.items.slice();this.validateRow(n[0])?(n.unshift(e),this.items=n,this.editID=e.UserID,this.$nextTick(function(){document.querySelector("tr.k-master-row").firstChild.firstChild.focus()})):this.alert()},remove:function(t){if(confirm("Voulez-vous supprimer cette entrée ?")){var e=this.items.slice(),n=e.findIndex(function(e){return e.UserID===t.dataItem.UserID});e[n].new?e.splice(n,1):e[n].deleted=!0,this.items=e}},saveChanges:function(){var t=this;if(this.editID){var e=this.items.slice().find(function(e){return e.UserID==t.editID});if(!this.validateRow(e))return void this.alert()}var n=this;this.editID=null,this.loading=!0;var a={destroy:this.items.filter(function(t){return t.deleted}),update:this.items.filter(function(t){return t.edited}),store:this.items.filter(function(t){return t.new})};function r(t){var e="users/"+t;return new Promise(function(r,i){a[t].length?n.$store.dispatch(e,a[t]).then(function(e){"store"==t&&console.log("end store ",e),"update"==t&&console.log("end update ",e),"destroy"==t&&console.log("end destroy ",e),r()}):r()})}function i(t){return o.apply(this,arguments)}function o(){return(o=R(w.a.mark(function t(e){return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(e);case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}function s(){return(s=R(w.a.mark(function t(e){var a,r,o,s,c,l;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=!0,r=!1,o=void 0,t.prev=3,s=e[Symbol.iterator]();case 5:if(a=(c=s.next()).done){t.next=12;break}return l=c.value,t.next=9,i(l);case 9:a=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),r=!0,o=t.t0;case 18:t.prev=18,t.prev=19,a||null==s.return||s.return();case 21:if(t.prev=21,!r){t.next=24;break}throw o;case 24:return t.finish(21);case 25:return t.finish(18);case 26:n.loadItems(),n.editID=null,n.loading=!1,console.log("Done! 11");case 30:case"end":return t.stop()}},t,null,[[3,14,18,26],[19,,21,25]])}))).apply(this,arguments)}!function(t){s.apply(this,arguments)}(["store","update","destroy"])},cancelChanges:function(){confirm("Voulez-vous annuler les modifications?")&&(this.items=this.users.map(function(t){return Object.assign({new:!1,edited:!1,deleted:!1},t)}),this.editID=null)},filterChange:function(t){this.filter=t.filter},columnReorder:function(t){this.columns=t.columns},sortChangeHandler:function(t){this.sort=t.sort},validateRow:function(t){if(null!=t){var e=!!t.UserName&&!!t.CompanyFID;return t.new&&(e=e&&!!t.Password),e}return!0},addKeyHandler:function(t){window.addEventListener("keydown",this.keyHandler)},removeKeyHandler:function(){window.removeEventListener("keydown",this.keyHandler)},keyHandler:function(t){var e=t.which||t.keyCode;13===e&&t.ctrlKey&&this.saveChanges(),32===e&&t.ctrlKey&&this.addRecord()},alert:function(){this.$toasted.info("Veuillez remplir les champs obligatoires!!! ( Nom, Pass, Company)",{action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"})}}),beforeDestroy:function(){D.$off("tab-pressed",this.nextRow),this.removeKeyHandler()},beforeRouteLeave:function(t,e,n){this.waitingForSave?confirm("Voulez-vous partir sans enregistrer ?")?n():n(!1):n()}},z=Object(d.a)(H,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100"},[n("Grid",{ref:"grid",style:{height:"100%"},attrs:{"data-items":t.getData,"edit-field":"inEdit",resizable:!0,reorderable:!0,filterable:!0,filter:t.filter,sortable:!0,sort:t.sort,columns:t.columns},on:{rowclick:t.rowClick,itemchange:t.itemChange,remove:t.remove,columnreorder:t.columnReorder,filterchange:t.filterChange,sortchange:t.sortChangeHandler}},[n("grid-toolbar",{staticClass:"bg-danger"},[n("div",{staticClass:"d-flex justify-content-between",on:{click:t.closeEdit}},[n("div",[n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+Space"},on:{click:t.addRecord}},[n("i",{staticClass:"fa fa-user-plus"}),t._v(" Ajouter\n                    ")]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+Enter"},on:{click:t.saveChanges}},[n("i",{staticClass:"fa fa-save"}),t._v(" \n                        Save \n                        "),n("span",{staticClass:"badge badge-secondary"},[t._v(t._s(t.waitingForSave))])]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Refresh"},on:{click:t.refreshData}},[n("i",{staticClass:"fa fa-download"}),t._v(" Load\n                    ")])]),t._v(" "),n("div",[n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Cancel Changes"},on:{click:t.cancelChanges}},[n("i",{staticClass:"fa fa-undo"}),t._v(" Annuler\n                    ")]),t._v(" "),n("user-details",{attrs:{name:"User",value:t.UserName}}),t._v(" "),n("user-details",{attrs:{name:"Branch",value:t.Company}})],1)])])],1),t._v(" "),t.loading?n("loading"):t._e()],1)},[],!1,null,null,null).exports,L=n("YUP2"),K=n("zuR4"),q="/api/v1",Y=q+"/user",X=q+"/transactions",W=q+"/phone_types",G={Orange:function(t){return t.match(/^(84|85|89|80|084|085|089|080)\d{7}/)},Airtel:function(t){return t.match(/^(99|98|97)\d{7}/)}};function J(t,e,n,a,r,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,r)}function Z(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var i=t.apply(e,n);function o(t){J(i,a,r,o,s,"next",t)}function s(t){J(i,a,r,o,s,"throw",t)}o(void 0)})}}function Q(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){et(t,e,n[e])})}return t}function et(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var nt={components:{NumberCell:$},data:function(){return{selectedField:"selected",loading:!1,verifying:!0,items:[],editID:null,staticColumns:[{field:"Company",title:"From Branch",cell:O},{field:"MVNumber",title:"Phone Number",cell:U},{field:"MVAmount",title:"Amount",cell:$},{field:"Type",title:"Type",cell:F},{field:"MVCurrency",title:"Currency",editable:!1,filterable:!1,width:"90px"},{field:"MVNotes",title:"Notes"},{field:"USSDResponse",title:"Response",cell:A},{field:"MVDate",filter:"date",editor:"date",title:"Date",format:"{0:d}",width:"230px"},{field:"Sent",title:"Sent",cell:E,width:"100px"},{title:"Del",filterable:!1,cell:j,width:"100px"}],filter:{logic:"and",filters:[]},enableFilter:!1,sort:[],json_fields:{Company:"Company",MVNumber:"MVNumber",MVAmount:"MVAmount",MVCurrency:"MVCurrency",MVNotes:"MVNotes",MVDate:"MVDate"},connected:!1,from:(new Date).toISOString().split("T")[0],to:(new Date).toISOString().split("T")[0],toolbarBg:"bg-danger",waitingForResponse:null,selectedCount:0,isBatch:!1,provider:window.myprovider}},mounted:function(){console.log(this.provider),this.loadItems(!0),D.$on("tab-pressed",this.nextRow),D.$on("set-false",this.setSentFalse),D.$on("ussd",this.ussdHandler),this.addKeyHandler()},computed:tt({areAllSelected:function(){return-1===this.items.findIndex(function(t){return!1===t.selected})},columns:function(){return[{field:"selected",width:"50px",filterable:!1,headerSelectionValue:this.areAllSelected}].concat(Q(this.staticColumns))},mvOrangeList:function(){var t=this;return this.items.map(function(e){return Object.assign({inEdit:e.TransactionID===t.editID},e)})},getData:function(){return Object(C.b)(Object(C.a)(this.mvOrangeList,this.filter),this.sort)},total:function(){return this[this.$route.params.currency+"Total"]}},Object(c.d)({fc:function(t){return t.mvOrange.fc},usd:function(t){return t.mvOrange.usd},fcTotal:function(t){return t.mvOrange.fcTotal},usdTotal:function(t){return t.mvOrange.usdTotal},UserName:function(t){return t.auth.UserName},Company:function(t){return t.auth.Company},UserID:function(t){return t.auth.UserID},currencies:function(t){return t.currencies.currencies},selectedCurrency:function(t){return t.currencies.selected}}),{waitingForSave:function(){var t=0;return this.items.forEach(function(e){(e.edited||e.deleted||e.new)&&t++}),I(t),t}}),beforeRouteEnter:function(t,e,n){n(function(e){if(e.changeToolBarBg(t.params.currency),null!==e.selectedCurrency){var n=e.currencies.find(function(e){return e.Currency.toUpperCase()===t.params.currency.toUpperCase()});e.selectCurrency(n)}})},beforeRouteUpdate:function(t,e,n){if(null!==this.selectedCurrency){var a=this.currencies.find(function(e){return e.Currency.toUpperCase()===t.params.currency.toUpperCase()});this.selectCurrency(a)}n()},watch:{$route:function(t,e){this.changeToolBarBg(t.params.currency),this.loadItems(!0)},items:function(t){var e=this;this.selectedCount=0,t.forEach(function(t){t.selected&&0==t.Sent&&e.selectedCount++})}},methods:tt({onHeaderSelectionChange:function(t){var e=t.event.target.checked,n=this.items.slice();n.map(function(t){return tt({},t,{selected:e})}),this.items=n,r.a.set(this,"items",this.items.map(function(t){return tt({},t,{selected:e})}))},onSelectionChange:function(t){var e=this.items.slice(),n=e.findIndex(function(e){return e.TransactionID===t.dataItem.TransactionID});e[n]=tt({},e[n],{selected:!t.dataItem[this.selectedField]}),this.items=e,r.a.set(t.dataItem,this.selectedField,!t.dataItem[this.selectedField])},createRandomData:function(t){}},Object(c.b)({getMvOranges:"mvOrange/getMvOranges",selectCurrency:"currencies/selectCurrency"}),{refreshData:function(){var t=this,e=this.currencies.find(function(e){return e.Currency.toUpperCase()===t.$route.params.currency.toUpperCase()});if(this.selectCurrency(e),this.waitingForSave){var n=this;this.$dialog.confirm({title:"Do you want to Load Data without saving changes ?",body:"You have to save changes before loading data"},{okText:"Save changes",cancelText:"Load"}).then(function(){console.log("ok"),n.saveChanges()}).catch(function(){console.log("cancel"),n.loadItems()})}else this.loadItems()},loadItemsFromState:function(){this.items=this[this.$route.params.currency].map(function(t){return Object.assign({new:!1,edited:!1,deleted:!1,selected:!1},t)}),this.loading=!1,this.editID=null},loadItems:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0,e?this.loadItemsFromState():this.getMvOranges({currency:this.selectedCurrency,from:this.from,to:this.to}).then(function(e){t.loadItemsFromState()}).catch(function(e){var n=e.response;n?t.$toasted.global.my_app_error({message:"".concat(n.data.message," (status: ").concat(n.status,")")}):t.$toasted.global.my_app_error({message:"Erreur réseau, veuillez vérifier votre connexion internet!"}),t.loading=!1})},itemChange:function(t){var e=this,n=t.field,a=t.value;["MVDate"].includes(n)&&(a=a.toISOString().split("T")[0]);var r=this.items.slice(),i=r.findIndex(function(e){return e.TransactionID===t.dataItem.TransactionID});if(["Company"].includes(n)){var o,s=a.foreignKey,c=a.foreignKeyValue,l=a.value;r[i]=tt({},r[i],(et(o={},n,l),et(o,s,c),o))}else r[i]=tt({},r[i],et({},n,a));var u=this[this.$route.params.currency].slice(),d=u.findIndex(function(e){return e.TransactionID===t.dataItem.TransactionID});r[i].new||(x(r[i],u[d])?r[i].edited=!1:r[i].edited=!0),this.items=r,"MVNumber"==t.field&&K.a.get("/api/v1/phone_types/"+t.value).then(function(n){var a=e.items.map(function(e){return e.TransactionID===t.dataItem.TransactionID&&(e.Type=Object.keys(n.data).length>0?n.data.Type:""),e});e.items=a}),this.$set(t.dataItem,n,a)},rowClick:function(t){var e=this;if(this.editID){var n=this.items.slice().find(function(t){return t.TransactionID==e.editID});if(!this.validateRow(n))return void this.alert()}t.dataItem.deleted||0!=t.dataItem.Sent||(this.editID=t.dataItem.TransactionID,this.$set(t.dataItem,"inEdit",!0))},amountClick:function(t,e){},closeEdit:function(t){var e=this;if(this.editID){var n=this.items.slice().find(function(t){return t.TransactionID==e.editID});if(!this.validateRow(n))return void this.alert()}t.target===t.currentTarget&&(this.editID=null)},nextRow:function(t){var e=this,n=this.items.slice();if(this.editID){var a=n.find(function(t){return t.TransactionID==e.editID});if(!this.validateRow(a))return void this.alert()}var r=n.findIndex(function(e){return e.TransactionID==t.TransactionID});this.editID=null,r++,n.length===r||this.$nextTick(function(){n[r].deleted||0!=n[r].Sent||(e.editID=n[r].TransactionID)})},getUniqueId:function(){var t=+new Date;return t=String(this.UserID)+String(t),Number(t)},addRecord:function(t){var e=this,n=this.currencies.find(function(t){return t.Currency.toUpperCase()===e.$route.params.currency.toUpperCase()});if(this.selectCurrency(n),null!==this.selectedCurrency){var a={TransactionID:this.getUniqueId(),new:!0,MVDate:(new Date).toISOString().split("T")[0],MVCurrency:this.selectedCurrency.Currency,Sent:0},r=this.items.slice();this.validateRow(r[0])?(r.unshift(a),this.items=r,this.editID=a.TransactionID,this.$nextTick(function(){document.querySelector("select.form-control.form-control-sm").focus()})):this.alert()}else alert("Loading state! retry later!")},remove:function(t){if(confirm("Voulez-vous supprimer cette entrée ?")){var e=this.items.slice(),n=e.findIndex(function(e){return e.TransactionID===t.dataItem.TransactionID});e[n].new?e.splice(n,1):e[n].deleted=!0,this.items=e}},saveChanges:function(){var t=this;if(this.editID){var e=this.items.slice().find(function(e){return e.TransactionID==t.editID});if(!this.validateRow(e))return void this.alert()}var n=this;this.editID=null;var a={destroy:this.items.filter(function(t){return t.deleted}),update:this.items.filter(function(t){return t.edited}),store:this.items.filter(function(t){return t.new})};function r(t){var e="mvOrange/"+t;return new Promise(function(r,i){a[t].length?n.$store.dispatch(e,a[t]).then(function(e){"store"==t&&console.log("end store ",e),"update"==t&&console.log("end update ",e),"destroy"==t&&console.log("end destroy ",e),r()}):r()})}function i(t){return o.apply(this,arguments)}function o(){return(o=Z(w.a.mark(function t(e){return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(e);case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}function s(){return(s=Z(w.a.mark(function t(e){var a,r,o,s,c,l;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=!0,r=!1,o=void 0,t.prev=3,s=e[Symbol.iterator]();case 5:if(a=(c=s.next()).done){t.next=12;break}return l=c.value,t.next=9,i(l);case 9:a=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),r=!0,o=t.t0;case 18:t.prev=18,t.prev=19,a||null==s.return||s.return();case 21:if(t.prev=21,!r){t.next=24;break}throw o;case 24:return t.finish(21);case 25:return t.finish(18);case 26:n.loadItems(),n.editID=null,n.loading=!1,console.log("Done! 11");case 30:case"end":return t.stop()}},t,null,[[3,14,18,26],[19,,21,25]])}))).apply(this,arguments)}null!==this.selectedCurrency&&(this.loading=!0,function(t){s.apply(this,arguments)}(["store","update","destroy"]))},cancelChanges:function(){confirm("Voulez-vous annuler les modifications?")&&(this.items=this[this.$route.params.currency].map(function(t){return Object.assign({new:!1,edited:!1,deleted:!1},t)}),this.editID=null)},dataForExport:function(){var t=this;return new Promise(function(e){e(t[t.$route.params.currency].map(function(t){return tt({},t)}))})},exportExcel:function(){var t=[{field:"Company",title:"Company"},{field:"MVNumber",title:"MVNumber"},{field:"MVAmount",title:"MVAmount"},{field:"MVCurrency",title:"MVCurrency"},{field:"MVNotes",title:"MVNotes"},{field:"MVDate",title:"MVDate"}];this.dataForExport().then(function(e){Object(L.a)({data:e,fileName:"MVOrange",columns:t})})},filterChange:function(t){if(t.filter){var e=t.filter.filters.map(function(t){return"MVDate"===t.field?tt({},t,{value:new Date(t.value).toISOString().split("T")[0]}):t});t.filter.filters=e}this.filter=t.filter},columnReorder:function(t){this.columns=t.columns},sortChangeHandler:function(t){this.sort=t.sort},validateRow:function(t){if(null!=t){if(t.MVNumber){if(t.MVNumber.length<9||t.MVNumber.length>10)return this.$toasted.info("This is an invalid number",{action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"}),!1;if(!G[this.provider](t.MVNumber))return this.$toasted.info("This is an invalid ".concat(this.provider," number beginning without 0"),{action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"}),!1}return!!(t.CompanyFID&&t.MVNumber&&t.MVAmount&&t.MVDate)}return!0},addKeyHandler:function(t){window.addEventListener("keydown",this.keyHandler)},removeKeyHandler:function(){window.removeEventListener("keydown",this.keyHandler)},keyHandler:function(t){var e=t.which||t.keyCode;13===e&&t.ctrlKey&&this.saveChanges(),32===e&&t.ctrlKey&&this.addRecord(),77===e&&t.ctrlKey&&this.refreshData(),66===e&&t.ctrlKey&&this.cancelChanges()},alert:function(){this.$toasted.info("Veuillez remplir les champs obligatoires!!! ( Branch, Number, Amount, Date )",{action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"})},sendBatch:function(){var t=this.items.find(function(t){return t.selected&&0==t.Sent});t&&this.ussdHandler(t,!0)},ussdHandler:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.TransactionID>2147483647?alert("Please save new records to the database before sending money"):(this.isBatch=n,this.verifying=!0,this.waitingForResponse=t,K.a.get(X+"/check/"+t.TransactionID).then(function(n){e.verifying=!1;var a=t.MVNumber,r=t.MVAmount,i=localStorage.getItem("port"),o=JSON.parse(localStorage.getItem(e.$route.params.currency+"-cmds")).slice();if(i&&o&&o.length>0)if(confirm("Do you want to send ".concat(r," ").concat(e.$route.params.currency.toUpperCase()," to ").concat(a," ?"))){for(var s=[],c=0;c<o.length;c++)s.push(o[c].replace("NUMBER",a).replace("AMOUNT",r));var l=new FormData;l.append("data",JSON.stringify(s)),l.append("port",i);K.a.post("http://localhost:5500/api",l,{headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"}}).then(function(t){e.ussdResponse(t.data)}).catch(function(t){if(e.waitingForResponse=null,t.response){var n=t.response.data;n.data.message?e.$toasted.global.my_app_error({message:n.data.message}):e.$toasted.global.my_app_error({message:n})}else e.$toasted.global.my_app_error({message:"Erreur!, veuillez vérifier votre serveur USSD!"})})}else e.waitingForResponse=null;else e.waitingForResponse=null,e.$toasted.info("Please set the USSD config",{action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"})}).catch(function(t){if(e.verifying=!0,e.waitingForResponse=null,t.response){console.log(t.response);var n=t.response.data;n.message?e.$toasted.global.my_app_error({message:n.message}):e.$toasted.global.my_app_error({message:n})}else e.$toasted.global.my_app_error({message:"Erreur!, veuillez vérifier reseau!"})}))},ussdResponse:function(t){var e=this,n=t.data.message;if(this.waitingForResponse){var a=this.items.slice(),r=a.findIndex(function(t){return t.TransactionID===e.waitingForResponse.TransactionID});a[r]=tt({},a[r],{USSDResponse:n,Sent:n.startsWith("Transaction reussie.")?1:0});var i=this[this.$route.params.currency].slice(),o=i.findIndex(function(t){return t.TransactionID===e.waitingForResponse.TransactionID});this.isBatch&&(a[r].selected=!1),a[r].new||(x(a[r],i[o])?a[r].edited=!1:a[r].edited=!0),this.items=a,this.$set(this.waitingForResponse,"USSDResponse",n),this.waitingForResponse=null,this.isBatch&&this.selectedCount>0&&setTimeout(function(){e.sendBatch()},300)}},changeToolBarBg:function(t){"usd"==t&&(this.toolbarBg="bg-success"),"fc"==t&&(this.toolbarBg="bg-info")},setSentFalse:function(t){var e=this.items.slice(),n=e.findIndex(function(e){return e.TransactionID===t.TransactionID});e[n]=tt({},e[n],{Sent:0});var a=this[this.$route.params.currency].slice(),r=a.findIndex(function(e){return e.TransactionID===t.TransactionID});e[n].new||(x(e[n],a[r])?e[n].edited=!1:e[n].edited=!0),this.items=e,this.$set(t,"Sent",0)}}),beforeDestroy:function(){D.$off("tab-pressed",this.nextRow),D.$off("set-false",this.setSentFalse),D.$off("ussd",this.ussdHandler),this.removeKeyHandler()},beforeRouteLeave:function(t,e,n){if(this.waitingForSave){var a=this;this.$dialog.confirm({title:"Do you want to leave ?",body:"You have to save changes before leaving!!!"},{okText:"Save changes",cancelText:"Leave"}).then(function(){console.log("ok"),a.saveChanges()}).catch(function(){console.log("cancel"),n()})}else n()}},at=(n("i+wo"),Object(d.a)(nt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100"},[n("Grid",{ref:"grid",style:{height:"100%"},attrs:{"data-items":t.getData,"edit-field":"inEdit",resizable:!0,reorderable:!0,filterable:t.enableFilter,filter:t.filter,sortable:!0,sort:t.sort,columns:t.columns,"selected-field":t.selectedField},on:{rowclick:t.rowClick,itemchange:t.itemChange,remove:t.remove,columnreorder:t.columnReorder,filterchange:t.filterChange,sortchange:t.sortChangeHandler,selectionchange:t.onSelectionChange,headerselectionchange:t.onHeaderSelectionChange},scopedSlots:t._u([{key:"myNumberCell",fn:function(e){var a=e.props;return[n("NumberCell",{attrs:{"data-item":a.dataItem,field:a.field},on:{amountClick:t.amountClick}})]}}])},[n("grid-toolbar",{class:t.toolbarBg},[n("div",[n("div",{staticClass:"d-flex justify-content-between",on:{click:t.closeEdit}},[n("div",[n("div",{staticClass:"d-inline-block"},[n("div",{staticClass:"input-group input-group-sm"},[n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("From")])]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.from,expression:"from"}],staticClass:"form-control form-control-sm",attrs:{type:"date"},domProps:{value:t.from},on:{input:function(e){e.target.composing||(t.from=e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"d-inline-block"},[n("div",{staticClass:"input-group input-group-sm"},[n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("To")])]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.to,expression:"to"}],staticClass:"form-control form-control-sm",attrs:{type:"date"},domProps:{value:t.to},on:{input:function(e){e.target.composing||(t.to=e.target.value)}}})])]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+M"},on:{click:function(e){return e.stopPropagation(),t.refreshData(e)}}},[n("i",{staticClass:"fa fa-download"}),t._v(" Load\n            ")])]),t._v(" "),n("div",[n("user-details",{attrs:{name:"User",value:t.UserName}}),t._v(" "),n("user-details",{attrs:{name:"Branch",value:t.Company}})],1)]),t._v(" "),n("div",{staticClass:"d-flex justify-content-between",on:{click:t.closeEdit}},[n("div",[n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+Space"},on:{click:function(e){return e.stopPropagation(),t.addRecord(e)}}},[n("i",{staticClass:"fa fa-user-plus"}),t._v(" Ajouter\n            ")]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+Enter"},on:{click:function(e){return e.stopPropagation(),t.saveChanges(e)}}},[n("i",{staticClass:"fa fa-save"}),t._v("\n              Save\n              "),n("span",{staticClass:"badge badge-secondary"},[t._v(t._s(t.waitingForSave))])]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+B"},on:{click:function(e){return e.stopPropagation(),t.cancelChanges(e)}}},[n("i",{staticClass:"fa fa-undo"}),t._v(" Annuler\n            ")]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Filter"},on:{click:function(e){e.stopPropagation(),t.enableFilter=!t.enableFilter}}},[n("i",{staticClass:"fa fa-filter"}),t._v(" Filter\n            ")]),t._v(" "),t.selectedCount>0?n("button",{staticClass:"btn btn-info btn-sm",on:{click:function(e){return e.stopPropagation(),t.sendBatch(e)}}},[t._v("Send to "+t._s(t.selectedCount)+" Seleted")]):t._e()]),t._v(" "),n("div",[n("button",{staticClass:"btn btn-dark btn-sm btn-sized",on:{click:function(e){return e.stopPropagation(),t.exportExcel(e)}}},[n("i",{staticClass:"fa fa-file-excel"}),t._v(" Excel\n            ")]),t._v(" "),n("div",{staticClass:"d-inline-block"},[n("div",{staticClass:"input-group input-group-sm mb-3"},[n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[t._v("Total")])]),t._v(" "),n("input",{staticClass:"form-control",staticStyle:{width:"130px"},attrs:{type:"text",disabled:""},domProps:{value:new Intl.NumberFormat("en-US").format(t.total)}})])])])])])])],1),t._v(" "),t.loading?n("loading"):t._e(),t._v(" "),null!=t.waitingForResponse?n("div",{staticClass:"sending p-3 card bg-success text-white"},[n("span",[n("i",{staticClass:"fa fa-spinner fa-spin"}),t._v(" "),t.verifying?n("span",[t._v("Verifying")]):n("span",[t._v("Sending")]),t._v(" \n      "+t._s(t.waitingForResponse.MVAmount)+" "+t._s(t.waitingForResponse.MVCurrency)+" to "+t._s(t.waitingForResponse.MVNumber)+"\n    ")])]):t._e()],1)},[],!1,null,"223ca442",null).exports);function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){it(t,e,n[e])})}return t}function it(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var ot={data:function(){return{loading:!1,items:[],columns:[{field:"id",filterable:!1,editable:!1,title:"#",width:"80px"},{field:"number",width:"150px",title:"Sent From",editable:!1},{field:"text",title:"Message",cell:A},{field:"time",width:"300px",title:"Time"},{field:"database",title:"Database",cell:N,width:"100px",filterable:!1}],filter:null,sort:[],from:(new Date).toISOString().split("T")[0],to:(new Date).toISOString().split("T")[0]}},mounted:function(){this.loadItems(!0),this.addKeyHandler()},computed:rt({getData:function(){return Object(C.b)(Object(C.a)(this.items,this.filter),this.sort)}},Object(c.d)({UserName:function(t){return t.auth.UserName},Company:function(t){return t.auth.Company},sms:function(t){return t.sms.sms}}),{waitingForSave:function(){var t=0;return this.items.forEach(function(e){e.database||t++}),I(t),t}}),methods:rt({},Object(c.b)({getSms:"sms/loadData",saveSms:"sms/saveData"}),{refreshData:function(){this.loadItems()},loadItemsFromState:function(){this.items=this.sms.map(function(t){return t}),this.loading=!1},loadItems:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0,e?this.loadItemsFromState():this.getSms({from:this.from,to:this.to}).then(function(e){t.loadItemsFromState()}).catch(function(e){t.$toasted.global.my_app_error({message:"Erreur!!!"}),t.loading=!1})},saveToDB:function(){var t=this;this.loading=!0,this.saveSms().then(function(e){t.refreshData(),t.loading=!1}).catch(function(e){console.log(e),t.loading=!1})},filterChange:function(t){this.filter=t.filter},columnReorder:function(t){this.columns=t.columns},sortChangeHandler:function(t){this.sort=t.sort},addKeyHandler:function(t){window.addEventListener("keydown",this.keyHandler)},removeKeyHandler:function(){window.removeEventListener("keydown",this.keyHandler)},keyHandler:function(t){var e=t.which||t.keyCode;13===e&&t.ctrlKey&&this.saveToDB(),77===e&&t.ctrlKey&&this.refreshData()}}),beforeDestroy:function(){this.removeKeyHandler()},beforeRouteLeave:function(t,e,n){if(this.waitingForSave){var a=this;this.$dialog.confirm({title:"Do you want to leave ?",body:"You have to backup sms before leaving!!!"},{okText:"Save changes",cancelText:"Leave"}).then(function(){console.log("ok"),a.saveToDB()}).catch(function(){console.log("cancel"),n()})}else n()}},st=Object(d.a)(ot,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100"},[n("Grid",{ref:"grid",style:{height:"100%"},attrs:{"data-items":t.getData,resizable:!0,reorderable:!0,filterable:!0,filter:t.filter,sortable:!0,sort:t.sort,columns:t.columns},on:{columnreorder:t.columnReorder,filterchange:t.filterChange,sortchange:t.sortChangeHandler}},[n("grid-toolbar",{staticClass:"bg-danger"},[n("div",{staticClass:"d-flex justify-content-between"},[n("div",[n("div",{staticClass:"d-inline-block"},[n("div",{staticClass:"input-group input-group-sm"},[n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("From")])]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.from,expression:"from"}],staticClass:"form-control form-control-sm",attrs:{type:"date"},domProps:{value:t.from},on:{input:function(e){e.target.composing||(t.from=e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"d-inline-block"},[n("div",{staticClass:"input-group input-group-sm"},[n("div",{staticClass:"input-group-prepend"},[n("span",{staticClass:"input-group-text"},[t._v("To")])]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.to,expression:"to"}],staticClass:"form-control form-control-sm",attrs:{type:"date"},domProps:{value:t.to},on:{input:function(e){e.target.composing||(t.to=e.target.value)}}})])]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+M"},on:{click:function(e){return e.stopPropagation(),t.refreshData(e)}}},[n("i",{staticClass:"fa fa-download"}),t._v(" Load\n          ")]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+Enter"},on:{click:function(e){return e.stopPropagation(),t.saveToDB(e)}}},[n("i",{staticClass:"fa fa-save"}),t._v("\n            Backup to DB\n            "),n("span",{staticClass:"badge badge-secondary"},[t._v(t._s(t.waitingForSave))])])]),t._v(" "),n("div",[n("user-details",{attrs:{name:"User",value:t.UserName}}),t._v(" "),n("user-details",{attrs:{name:"Branch",value:t.Company}})],1)])])],1),t._v(" "),t.loading?n("loading"):t._e()],1)},[],!1,null,null,null).exports;function ct(t,e,n,a,r,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,r)}function lt(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var i=t.apply(e,n);function o(t){ct(i,a,r,o,s,"next",t)}function s(t){ct(i,a,r,o,s,"throw",t)}o(void 0)})}}function ut(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){dt(t,e,n[e])})}return t}function dt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var mt={data:function(){return{loading:!1,items:[],editID:null,columns:[{field:"PhoneNumber",title:"Phone Number",filterable:!0},{field:"Type",title:"Type",cell:F},{field:"Note",title:"Note"},{title:"Del",filterable:!1,cell:P,width:"60px",locked:!0}],filter:{logic:"and",filters:[]},sort:[],nextId:1e6,provider:window.myprovider}},mounted:function(){this.loadItems(!0),this.addKeyHandler()},computed:ut({usersList:function(){var t=this;return this.items.map(function(e){return Object.assign({inEdit:e.PhoneTypeID===t.editID},e)})},getData:function(){return Object(C.b)(Object(C.a)(this.usersList,this.filter),this.sort)}},Object(c.d)({users:function(t){return t.phone_types.phone_types},UserName:function(t){return t.auth.UserName},Company:function(t){return t.auth.Company}}),{waitingForSave:function(){var t=0;return this.items.forEach(function(e){(e.edited||e.deleted||e.new)&&t++}),I(t),t}}),methods:ut({},Object(c.b)({getUsers:"phone_types/getUsers"}),{refreshData:function(){this.loadItems()},loadItemsFromState:function(){this.items=this.users.map(function(t){return Object.assign({new:!1,edited:!1,deleted:!1},t)}),this.loading=!1,this.editID=null},loadItems:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.loading=!0,e?this.loadItemsFromState():this.getUsers().then(function(e){t.loadItemsFromState()}).catch(function(e){var n=e.response;n?t.$toasted.global.my_app_error({message:"".concat(n.data.message," (status: ").concat(n.status,")")}):t.$toasted.global.my_app_error({message:"Erreur réseau, veuillez vérifier votre connexion internet!"}),t.loading=!1})},itemChange:function(t){var e=t.field,n=t.value,a=this.items.slice(),r=a.findIndex(function(e){return e.PhoneTypeID===t.dataItem.PhoneTypeID});if(["Company"].includes(e)){var i,o=n.foreignKey,s=n.foreignKeyValue,c=n.value;a[r]=ut({},a[r],(dt(i={},e,c),dt(i,o,s),i))}else a[r]=ut({},a[r],dt({},e,n));var l=this.users.slice(),u=l.findIndex(function(e){return e.PhoneTypeID===t.dataItem.PhoneTypeID});a[r].new||(!function(t,e){var n=S(t.PhoneTypeID,e.PhoneTypeID),a=S(t.PhoneNumber,e.PhoneNumber),r=S(t.Type,e.Type),i=S(t.Note,e.Note);return n&&a&&r&&i}(a[r],l[u])?a[r].edited=!0:a[r].edited=!1),this.items=a,console.log(a),this.$set(t.dataItem,e,n)},rowClick:function(t){var e=this;if(this.editID){var n=this.items.slice().find(function(t){return t.PhoneTypeID==e.editID});if(!this.validateRow(n))return void this.alert()}t.dataItem.deleted||(this.editID=t.dataItem.PhoneTypeID,this.$set(t.dataItem,"inEdit",!0),this.$nextTick(function(){}))},closeEdit:function(t){t.target===t.currentTarget&&(this.editID=null)},nextRow:function(t){var e=this,n=this.items.slice();if(this.editID){var a=n.find(function(t){return t.PhoneTypeID==e.editID});if(!this.validateRow(a))return void this.alert()}var r=n.findIndex(function(e){return e.PhoneTypeID==t.PhoneTypeID});this.editID=null,r++,n.length===r||this.$nextTick(function(){n[r].deleted||!n[r].new&&n[r].WeekFID!=e.currentWeek.WeekID||(e.editID=n[r].PhoneTypeID)})},addRecord:function(t){this.nextId++;var e={PhoneTypeID:this.nextId,new:!0},n=this.items.slice();this.validateRow(n[0])?(n.unshift(e),this.items=n,this.editID=e.PhoneTypeID,this.$nextTick(function(){document.querySelector("tr.k-master-row").firstChild.firstChild.focus()})):this.alert()},remove:function(t){if(confirm("Voulez-vous supprimer cette entrée ?")){var e=this.items.slice(),n=e.findIndex(function(e){return e.PhoneTypeID===t.dataItem.PhoneTypeID});e[n].new?e.splice(n,1):e[n].deleted=!0,this.items=e}},saveChanges:function(){var t=this;if(this.editID){var e=this.items.slice().find(function(e){return e.PhoneTypeID==t.editID});if(!this.validateRow(e))return void this.alert()}var n=this;this.editID=null,this.loading=!0;var a={destroy:this.items.filter(function(t){return t.deleted}),update:this.items.filter(function(t){return t.edited}),store:this.items.filter(function(t){return t.new})};function r(t){var e="phone_types/"+t;return new Promise(function(r,i){a[t].length?n.$store.dispatch(e,a[t]).then(function(e){"store"==t&&console.log("end store ",e),"update"==t&&console.log("end update ",e),"destroy"==t&&console.log("end destroy ",e),r()}):r()})}function i(t){return o.apply(this,arguments)}function o(){return(o=lt(w.a.mark(function t(e){return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r(e);case 2:case"end":return t.stop()}},t)}))).apply(this,arguments)}function s(){return(s=lt(w.a.mark(function t(e){var a,r,o,s,c,l;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a=!0,r=!1,o=void 0,t.prev=3,s=e[Symbol.iterator]();case 5:if(a=(c=s.next()).done){t.next=12;break}return l=c.value,t.next=9,i(l);case 9:a=!0,t.next=5;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(3),r=!0,o=t.t0;case 18:t.prev=18,t.prev=19,a||null==s.return||s.return();case 21:if(t.prev=21,!r){t.next=24;break}throw o;case 24:return t.finish(21);case 25:return t.finish(18);case 26:n.loadItems(),n.editID=null,n.loading=!1,console.log("Done! 11");case 30:case"end":return t.stop()}},t,null,[[3,14,18,26],[19,,21,25]])}))).apply(this,arguments)}!function(t){s.apply(this,arguments)}(["store","update","destroy"])},cancelChanges:function(){confirm("Voulez-vous annuler les modifications?")&&(this.items=this.users.map(function(t){return Object.assign({new:!1,edited:!1,deleted:!1},t)}),this.editID=null)},filterChange:function(t){this.filter=t.filter},columnReorder:function(t){this.columns=t.columns},sortChangeHandler:function(t){this.sort=t.sort},validateRow:function(t){if(null!=t){if(t.PhoneNumber){if(t.PhoneNumber.length<9||t.PhoneNumber.length>10)return this.$toasted.info("This is an invalid number",{action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"}),!1;if(!G[this.provider](t.PhoneNumber))return this.$toasted.info("This is an invalid ".concat(this.provider," number beginning without 0"),{action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"}),!1}return!!t.PhoneNumber&&!!t.Type}return!0},addKeyHandler:function(t){window.addEventListener("keydown",this.keyHandler)},removeKeyHandler:function(){window.removeEventListener("keydown",this.keyHandler)},keyHandler:function(t){var e=t.which||t.keyCode;13===e&&t.ctrlKey&&this.saveChanges(),32===e&&t.ctrlKey&&this.addRecord()},alert:function(){this.$toasted.info("Veuillez remplir les champs obligatoires!!! ( PhoneNumber, Type)",{action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:5e3,position:"bottom-center"})}}),beforeDestroy:function(){D.$off("tab-pressed",this.nextRow),this.removeKeyHandler()},beforeRouteLeave:function(t,e,n){this.waitingForSave?confirm("Voulez-vous partir sans enregistrer ?")?n():n(!1):n()}},ft=Object(d.a)(mt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100"},[n("Grid",{ref:"grid",style:{height:"100%"},attrs:{"data-items":t.getData,"edit-field":"inEdit",resizable:!0,reorderable:!0,filterable:!0,filter:t.filter,sortable:!0,sort:t.sort,columns:t.columns},on:{rowclick:t.rowClick,itemchange:t.itemChange,remove:t.remove,columnreorder:t.columnReorder,filterchange:t.filterChange,sortchange:t.sortChangeHandler}},[n("grid-toolbar",{staticClass:"bg-danger"},[n("div",{staticClass:"d-flex justify-content-between",on:{click:t.closeEdit}},[n("div",[n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+Space"},on:{click:t.addRecord}},[n("i",{staticClass:"fa fa-user-plus"}),t._v(" Ajouter\n                    ")]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Ctrl+Enter"},on:{click:t.saveChanges}},[n("i",{staticClass:"fa fa-save"}),t._v(" \n                        Save \n                        "),n("span",{staticClass:"badge badge-secondary"},[t._v(t._s(t.waitingForSave))])]),t._v(" "),n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Refresh"},on:{click:t.refreshData}},[n("i",{staticClass:"fa fa-download"}),t._v(" Load\n                    ")])]),t._v(" "),n("div",[n("button",{staticClass:"btn btn-dark btn-sm btn-sized",attrs:{title:"Cancel Changes"},on:{click:t.cancelChanges}},[n("i",{staticClass:"fa fa-undo"}),t._v(" Annuler\n                    ")]),t._v(" "),n("user-details",{attrs:{name:"User",value:t.UserName}}),t._v(" "),n("user-details",{attrs:{name:"Branch",value:t.Company}})],1)])])],1),t._v(" "),t.loading?n("loading"):t._e()],1)},[],!1,null,null,null).exports,pt={namespaced:!0,state:{UserName:localStorage.getItem("UserName")||"",UserID:localStorage.getItem("UserID")||"",AccessToken:localStorage.getItem("AccessToken")||"",Admin:localStorage.getItem("Admin")||0,status:"",Company:localStorage.getItem("Company")||""},getters:{isAuthenticated:function(t){return!!t.AccessToken},authStatus:function(t){return t.status},isSuperAdmin:function(t){return 1==t.Admin},isSimpleAdmin:function(t){return 2==t.Admin||1==t.Admin}},actions:{login:function(t,e){var n=t.commit;return new Promise(function(t,a){n("authRequest"),Object(K.a)({url:"/api/v1/login",data:e,method:"POST"}).then(function(e){n("authSuccess"),t(e)}).catch(function(t){n("authError",t),localStorage.removeItem("AccessToken"),localStorage.removeItem("UserID"),localStorage.removeItem("UserName"),localStorage.removeItem("Admin"),localStorage.removeItem("LoginTime"),localStorage.removeItem("Company"),a(t)})})},verifyCode:function(t,e){var n=t.commit;return new Promise(function(t,a){n("authRequest"),Object(K.a)({url:"/api/v1/verifyCode",data:e,method:"POST"}).then(function(e){var a=e.data.AccessToken;K.a.defaults.headers.common.Authorization="Bearer "+a;var r=e.data.UserID,i=e.data.UserName,o=e.data.Admin,s=e.data.Company;localStorage.setItem("AccessToken","Bearer "+a),localStorage.setItem("UserID",r),localStorage.setItem("UserName",i),localStorage.setItem("Admin",o),localStorage.setItem("LoginTime",new Date),localStorage.setItem("Company",s),n("authData",e.data),n("authSuccess"),t(e)}).catch(function(t){n("authError",t),localStorage.removeItem("AccessToken"),localStorage.removeItem("UserID"),localStorage.removeItem("UserName"),localStorage.removeItem("Admin"),localStorage.removeItem("LoginTime"),localStorage.removeItem("Company"),a(t)})})},logout:function(t){var e=t.commit,n=t.dispatch;t.rootState;e("logout"),K.a.get("/api/v1/logout"),localStorage.removeItem("AccessToken"),localStorage.removeItem("UserID"),localStorage.removeItem("UserName"),localStorage.removeItem("Admin"),localStorage.removeItem("LoginTime"),localStorage.removeItem("Company"),delete K.a.defaults.headers.common.Authorization,n("companies/clearState",null,{root:!0}),n("currencies/clearState",null,{root:!0}),n("mvOrange/clearState",null,{root:!0}),n("users/clearState",null,{root:!0}),Ft.push("/login")},checkTime:function(){return new Promise(function(t){var e=new Date(localStorage.getItem("LoginTime"));t(new Date-e>18e5)})}},mutations:{authRequest:function(t){t.status="loading"},authSuccess:function(t){t.status="success"},authData:function(t,e){t.AccessToken=e.AccessToken,t.UserID=e.UserID,t.UserName=e.UserName,t.Company=e.Company,t.Admin=e.Admin},authError:function(t){t.status="error"},logout:function(t){t.status="",t.AccessToken="",t.UserID="",t.UserName="",t.Admin=0,t.Company=""}}};function ht(t,e,n,a,r,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,r)}function vt(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var i=t.apply(e,n);function o(t){ht(i,a,r,o,s,"next",t)}function s(t){ht(i,a,r,o,s,"throw",t)}o(void 0)})}}function gt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){bt(t,e,n[e])})}return t}function bt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var yt={namespaced:!0,state:{users:[]},getters:{},actions:{getUsers:function(t){var e=t.commit;return new Promise(function(t,n){Object(K.a)(Y).then(function(n){e("usersData",n.data),t(n)}).catch(function(t){n(t)})})},store:function(t,e){t.state;return new Promise(function(t){var n={success:[],failed:[]};function a(t){return r.apply(this,arguments)}function r(){return(r=vt(w.a.mark(function t(e){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r=e,K.a.post(Y,gt({},r));case 3:a=t.sent,n.success.push(gt({},a,{fakeId:e.UserID})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n.failed.push(gt({},t.t0.response,{fakeId:e.UserID}));case 10:case"end":return t.stop()}var r},t,null,[[0,7]])}))).apply(this,arguments)}function i(){return(i=vt(w.a.mark(function e(r){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(a),e.next=3,Promise.all(i);case 3:t(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){i.apply(this,arguments)}(e)})},update:function(t,e){t.state;return new Promise(function(t){var n=[];function a(t){return r.apply(this,arguments)}function r(){return(r=vt(w.a.mark(function t(e){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r=e,K.a.put(Y+"/"+r.UserID,gt({},r));case 3:a=t.sent,n.push(a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n.push(t.t0.response);case 10:case"end":return t.stop()}var r},t,null,[[0,7]])}))).apply(this,arguments)}function i(){return(i=vt(w.a.mark(function e(r){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(a),e.next=3,Promise.all(i);case 3:t(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){i.apply(this,arguments)}(e)})},destroy:function(t,e){t.state;return new Promise(function(t){var n=[];function a(t){return r.apply(this,arguments)}function r(){return(r=vt(w.a.mark(function t(e){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r=e,K.a.delete(Y+"/"+r.UserID);case 3:a=t.sent,n.push(a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n.push(t.t0.response);case 10:case"end":return t.stop()}var r},t,null,[[0,7]])}))).apply(this,arguments)}function i(){return(i=vt(w.a.mark(function e(r){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(a),e.next=3,Promise.all(i);case 3:t(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){i.apply(this,arguments)}(e)})},clearState:function(t){(0,t.commit)("clearState")}},mutations:{usersData:function(t,e){t.users=e.data},clearState:function(t){t.users=[]}}};function wt(t,e,n,a,r,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,r)}function It(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var i=t.apply(e,n);function o(t){wt(i,a,r,o,s,"next",t)}function s(t){wt(i,a,r,o,s,"throw",t)}o(void 0)})}}function Ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){St(t,e,n[e])})}return t}function St(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var xt={namespaced:!0,state:{phone_types:[]},getters:{},actions:{getUsers:function(t){var e=t.commit;return new Promise(function(t,n){Object(K.a)(W).then(function(n){console.log(n),e("phoneTypesData",n.data),t(n)}).catch(function(t){n(t)})})},store:function(t,e){t.state;return new Promise(function(t){var n={success:[],failed:[]};function a(t){return r.apply(this,arguments)}function r(){return(r=It(w.a.mark(function t(e){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r=e,K.a.post(W,Ct({},r));case 3:a=t.sent,n.success.push(Ct({},a,{fakeId:e.PhoneTypeID})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n.failed.push(Ct({},t.t0.response,{fakeId:e.PhoneTypeID}));case 10:case"end":return t.stop()}var r},t,null,[[0,7]])}))).apply(this,arguments)}function i(){return(i=It(w.a.mark(function e(r){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(a),e.next=3,Promise.all(i);case 3:t(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){i.apply(this,arguments)}(e)})},update:function(t,e){t.state;return new Promise(function(t){var n=[];function a(t){return r.apply(this,arguments)}function r(){return(r=It(w.a.mark(function t(e){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r=e,K.a.put(W+"/"+r.PhoneTypeID,Ct({},r));case 3:a=t.sent,n.push(a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n.push(t.t0.response);case 10:case"end":return t.stop()}var r},t,null,[[0,7]])}))).apply(this,arguments)}function i(){return(i=It(w.a.mark(function e(r){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(a),e.next=3,Promise.all(i);case 3:t(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){i.apply(this,arguments)}(e)})},destroy:function(t,e){t.state;return new Promise(function(t){var n=[];function a(t){return r.apply(this,arguments)}function r(){return(r=It(w.a.mark(function t(e){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r=e,K.a.delete(W+"/"+r.PhoneTypeID);case 3:a=t.sent,n.push(a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n.push(t.t0.response);case 10:case"end":return t.stop()}var r},t,null,[[0,7]])}))).apply(this,arguments)}function i(){return(i=It(w.a.mark(function e(r){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(a),e.next=3,Promise.all(i);case 3:t(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){i.apply(this,arguments)}(e)})},clearState:function(t){(0,t.commit)("clearState")}},mutations:{phoneTypesData:function(t,e){t.phone_types=e.data},clearState:function(t){t.phone_types=[]}}},Dt={namespaced:!0,state:{companies:[]},getters:{},actions:{getCompanies:function(t){var e=t.commit;return new Promise(function(t,n){Object(K.a)("/api/v1/company").then(function(n){e("companiesData",n.data),t(n)}).catch(function(t){n(t)})})},clearState:function(t){(0,t.commit)("clearState")}},mutations:{companiesData:function(t,e){t.companies=e.data},clearState:function(t){t.companies=[]}}},kt={namespaced:!0,state:{currencies:[],selected:null},getters:{},actions:{getCurrencies:function(t){var e=t.commit;return new Promise(function(t,n){Object(K.a)("/api/v1/currency").then(function(n){e("currenciesData",n.data),t(n)}).catch(function(t){n(t)})})},selectCurrency:function(t,e){(0,t.commit)("select",e)},clearState:function(t){(0,t.commit)("clearState")}},mutations:{currenciesData:function(t,e){t.currencies=e.data},select:function(t,e){t.selected=e},clearState:function(t){t.currencies=[],t.selected=null}}};function _t(t,e,n,a,r,i,o){try{var s=t[i](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(a,r)}function Tt(t){return function(){var e=this,n=arguments;return new Promise(function(a,r){var i=t.apply(e,n);function o(t){_t(i,a,r,o,s,"next",t)}function s(t){_t(i,a,r,o,s,"throw",t)}o(void 0)})}}function Nt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){Ot(t,e,n[e])})}return t}function Ot(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Pt={namespaced:!0,state:{fc:[],usd:[],fcTotal:0,usdTotal:0},getters:{},actions:{getMvOranges:function(t,e){var n=t.commit;t.dispatch;return new Promise(function(t,a){Object(K.a)(X,{params:{currency:e.currency.CurrencyID,from:e.from,to:e.to}}).then(function(a){n("setTotal",{currency:e.currency.Currency,total:a.data.total}),n("mvOrangesData",{data:a.data.data,currency:e.currency.Currency}),t(a)}).catch(function(t){a(t)})})},store:function(t,e){t.state;var n=t.rootState;if(n.currencies.selected)return new Promise(function(t){var a={success:[],failed:[]};function r(t){return i.apply(this,arguments)}function i(){return(i=Tt(w.a.mark(function t(e){var r;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i=e,K.a.post(X,Nt({},i,{currency:n.currencies.selected.CurrencyID}));case 3:r=t.sent,a.success.push(Nt({},r,{fakeId:e.TransactionID})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a.failed.push(Nt({},t.t0.response,{fakeId:e.TransactionID}));case 10:case"end":return t.stop()}var i},t,null,[[0,7]])}))).apply(this,arguments)}function o(){return(o=Tt(w.a.mark(function e(n){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.map(r),e.next=3,Promise.all(i);case 3:t(a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){o.apply(this,arguments)}(e)})},update:function(t,e){t.state;return new Promise(function(t){var n=[];function a(t){return r.apply(this,arguments)}function r(){return(r=Tt(w.a.mark(function t(e){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r=e,K.a.put(X+"/"+r.TransactionID,Nt({},r));case 3:a=t.sent,n.push(a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n.push(t.t0.response);case 10:case"end":return t.stop()}var r},t,null,[[0,7]])}))).apply(this,arguments)}function i(){return(i=Tt(w.a.mark(function e(r){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(a),e.next=3,Promise.all(i);case 3:t(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){i.apply(this,arguments)}(e)})},destroy:function(t,e){t.state;return new Promise(function(t){var n=[];function a(t){return r.apply(this,arguments)}function r(){return(r=Tt(w.a.mark(function t(e){var a;return w.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r=e,console.log(r),K.a.delete(X+"/"+r.TransactionID);case 3:a=t.sent,n.push(a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),n.push(t.t0.response);case 10:case"end":return t.stop()}var r},t,null,[[0,7]])}))).apply(this,arguments)}function i(){return(i=Tt(w.a.mark(function e(r){var i;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(a),e.next=3,Promise.all(i);case 3:t(n);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(t){i.apply(this,arguments)}(e)})},clearState:function(t){(0,t.commit)("clearState")}},mutations:{mvOrangesData:function(t,e){t[e.currency.toLowerCase()]=e.data},setTotal:function(t,e){t[e.currency.toLowerCase()+"Total"]=e.total},clearState:function(t){t.usd=[],t.fc=[],t.totalFc=0,t.totalUsd=0}}},jt={namespaced:!0,state:{status:""},getters:{},actions:{loadData:function(t){var e=t.commit,n=t.dispatch;return new Promise(function(t,a){e("dataRequest"),n("companies/getCompanies",null,{root:!0}).then(function(t){return n("currencies/getCurrencies",null,{root:!0})}).then(function(n){e("dataSuccess"),t(n)}).catch(function(t){e("dataError"),a(t)})})},resetState:function(t){(0,t.commit)("reset")}},mutations:{reset:function(t){t.datacount=COUNT},dataRequest:function(t){t.status="loading"},dataSuccess:function(t){t.status="success"},dataError:function(t){t.status="error"}}};function At(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $t={namespaced:!0,state:{sms:[]},getters:{},actions:{loadData:function(t,e){var n=t.commit,a=e.from,r=e.to;return new Promise(function(t,e){window.readAllData("sms").then(function(e){var i=e.filter(function(t){var e=new Date(t.time).toISOString().split("T")[0];return a<=e&&e<=r});n("load",i),t()}).catch(function(t){e(t)})})},saveData:function(t){t.state;return new Promise(function(t,e){var n=[];window.readAllData("sms").then(function(t){n=t;var e=t.filter(function(t){return!t.database});return K.a.post("/api/v1/sms",e.reverse())}).then(function(e){var a=new Date;a.setDate(a.getDate()-7),a=a.toISOString().split("T")[0],n.forEach(function(t){window.writeData("sms",function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){At(t,e,n[e])})}return t}({},t,{database:!0})),new Date(t.time).toISOString().split("T")[0]<a&&window.deleteItemFromData("sms",t.id)}),t(e)}).catch(function(t){e(t)})})}},mutations:{load:function(t,e){t.sms=e.reverse()}}};r.a.use(c.a);var Ut=new c.a.Store({modules:{auth:pt,users:yt,companies:Dt,currencies:kt,mvOrange:Pt,data:jt,sms:$t,phone_types:xt},strict:!1});r.a.use(s.a);var Et=new s.a({mode:"history",routes:[{path:"/",component:b,meta:{requiresAuth:!0},children:[{path:"",name:"Home",redirect:"/transactions/usd"},{path:"transactions/:currency",name:"Transactions",component:at},{path:"sms",name:"SMS",component:st,meta:{requiresSimpleAdmin:!0}},{path:"phone_types",name:"Phone Type",component:ft,meta:{requiresSimpleAdmin:!0}},{path:"users",name:"Users",component:z,meta:{requiresSuperAdmin:!0}}]},{path:"/login",name:"login",component:m,meta:{requiresGuest:!0}},{path:"*",redirect:"/absences"}]});Et.beforeEach(function(t,e,n){t.matched.some(function(t){return t.meta.requiresAuth})?null==localStorage.getItem("AccessToken")?n({path:"/login",params:{nextUrl:t.fullPath}}):Ut.dispatch("auth/checkTime").then(function(t){t?Ut.dispatch("auth/logout"):(localStorage.setItem("LoginTime",new Date),n())}):n(),t.matched.some(function(t){return t.meta.requiresGuest})&&null!=localStorage.getItem("AccessToken")?n({path:"/"}):n(),t.matched.some(function(t){return t.meta.requiresSuperAdmin})?Ut.getters["auth/isSuperAdmin"]?n():n({path:"/"}):n(),t.matched.some(function(t){return t.meta.requiresSimpleAdmin})?Ut.getters["auth/isSimpleAdmin"]?n():n({path:"/"}):n()});var Ft=Et,Vt={watch:{isAppIdle:function(){this.isAppIdle&&localStorage.getItem("AccessToken")&&this.$store.dispatch("auth/logout")}}},Rt=(n("D0Mk"),Object(d.a)(Vt,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"main"}},[e("router-view")],1)},[],!1,null,null,null).exports),Mt=n("pl0M"),Bt=n.n(Mt),Ht=n("BXbG"),zt=n.n(Ht),Lt=n("A6WO"),Kt=n.n(Lt),qt=(n("xcXr"),n("cFE2"),n("ccID")),Yt={},Xt=(n("ZaBn"),Object(d.a)(Yt,function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"loading"}},[e("div",{staticClass:"loading"},[e("div",{staticClass:"loading-bar"}),this._v(" "),e("div",{staticClass:"loading-bar"}),this._v(" "),e("div",{staticClass:"loading-bar"}),this._v(" "),e("div",{staticClass:"loading-bar"})])])}],!1,null,null,null).exports),Wt={props:["currency"],data:function(){return{port:"",cmds:[]}},mounted:function(){this.fetch()},watch:{currency:function(){this.fetch()},port:function(t){localStorage.setItem("port",t)},cmds:function(t){localStorage.setItem(this.currency+"-cmds",JSON.stringify(t))}},methods:{fetch:function(){this.port=localStorage.getItem("port")?localStorage.getItem("port"):"",this.cmds=localStorage.getItem(this.currency+"-cmds")?JSON.parse(localStorage.getItem(this.currency+"-cmds")):[]},removeCmd:function(t){this.cmds.splice(t,1)},addCmd:function(t){this.cmds.push(t.target.value),t.target.value=""}}},Gt=Object(d.a)(Wt,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card text-white bg-secondary mb-3 w-100 h-100"},[n("div",{staticClass:"card-header"},[n("i",{staticClass:"fa fa-cogs"}),t._v(" Configuration "+t._s(t.currency.toUpperCase()))]),t._v(" "),n("div",{staticClass:"card-body"},[n("a",{staticClass:"text-warning",attrs:{href:"http://localhost:5500",target:"_blank"}},[t._v("check ussd server")]),t._v(" "),n("table",{staticClass:"table table-striped table-borderless table-sm text-white"},[n("tbody",[n("tr",[n("td",[t._v("COM")]),t._v(" "),n("td",{attrs:{colspan:"2"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.port,expression:"port"}],staticClass:"form-control form-control-sm",attrs:{type:"text"},domProps:{value:t.port},on:{input:function(e){e.target.composing||(t.port=e.target.value)}}})])]),t._v(" "),t._l(t.cmds,function(e,a){return n("tr",{key:a},[n("td",[t._v("CMD #"+t._s(a))]),t._v(" "),n("td",[t._v(t._s(e))]),t._v(" "),n("td",[n("button",{staticClass:"btn btn-sm btn-danger",on:{click:function(e){return t.removeCmd(a)}}},[t._v("X")])])])}),t._v(" "),n("tr",[n("td",{attrs:{colspan:"3"}},[n("input",{staticClass:"form-control form-control-sm",attrs:{type:"text",placeholder:"Press Enter to add a command"},on:{change:t.addCmd}})])])],2)])])])},[],!1,null,null,null).exports,Jt={props:["name","value"]},Zt=Object(d.a)(Jt,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-inline-block"},[e("div",{staticClass:"input-group input-group-sm mb-3"},[e("div",{staticClass:"input-group-prepend"},[e("span",{staticClass:"input-group-text",attrs:{id:"basic-addon1"}},[this._v(this._s(this.name))])]),this._v(" "),e("input",{staticClass:"form-control",staticStyle:{width:"109px"},attrs:{type:"text",disabled:""},domProps:{value:this.value}})])])},[],!1,null,null,null).exports,Qt=n("G91M");r.a.use(o.a,{store:Ut,idleTime:18e5}),r.a.use(Bt.a),r.a.use(zt.a),r.a.use(Kt.a),r.a.component("Grid",qt.a),r.a.component("grid-toolbar",qt.b),r.a.component("loading",Xt),r.a.component("downloadExcel",Qt.a),r.a.component("ussd-config",Gt),r.a.component("user-details",Zt),K.a.defaults.headers.common.Accept="application/json",K.a.defaults.headers.common["Content-Type"]="application/json",r.a.prototype.$http=K.a;var te=localStorage.getItem("AccessToken");te&&(K.a.defaults.headers.common.Authorization=te);r.a.toasted.register("my_app_error",function(t){return t.message?"&nbsp; Oops.. "+t.message:"&nbsp; Erreur réseau, veuillez vérifier votre connexion internet!"},{type:"error",iconPack:"fontawesome",icon:"exclamation-triangle",action:{text:"Fermer",onClick:function(t,e){e.goAway(0)}},duration:15e3,position:"bottom-center"});new r.a({el:"#app",components:{App:Rt},router:Ft,store:Ut})},dcUB:function(t,e,n){var a=n("F6lD");"string"==typeof a&&(a=[[t.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,r);a.locals&&(t.exports=a.locals)},gnhj:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"\n.my-layout[data-v-0bfbed29] {\r\n  width: 100%;\r\n  height: 100%;\r\n  padding-left: 300px;\r\n  transition: padding 0.3s ease;\n}\n.menuclosed[data-v-0bfbed29] {\r\n  padding-left: 50px;\n}\n.v-sidebar-menu[data-v-0bfbed29] {\r\n  z-index: 1;\n}\n.tips[data-v-0bfbed29] {\r\n  width: 300px;\r\n  height: 300px;\r\n  left: 50%;\r\n  top: 50%;\r\n  margin-left: -150px;\r\n  margin-top: -150px;\r\n  position: absolute;\r\n  z-index: 2;\n}\n.config[data-v-0bfbed29] {\r\n  width: 400px;\r\n  min-height: 300px;\r\n  left: 50%;\r\n  top: 50%;\r\n  margin-left: -200px;\r\n  margin-top: -150px;\r\n  position: absolute;\r\n  z-index: 2;\n}\n.port-warning[data-v-0bfbed29] {\r\n  position: absolute;\r\n  right: 30px;\r\n  bottom: 10px;\r\n  z-index: 9999;\n}\r\n",""])},"i+wo":function(t,e,n){"use strict";var a=n("dcUB");n.n(a).a},jxTe:function(t,e,n){var a=n("EXa1");"string"==typeof a&&(a=[[t.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,r);a.locals&&(t.exports=a.locals)},mqbg:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"\n#login[data-v-f9dfd950] {\n    width: 100%;\n    height: 100%;\n    background-color: #28a745;\n    /* background-image: url('/images/maxresdefault.jpg'); */\n    background-repeat: no-repeat;\n    background-size: cover;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    overflow-y: scroll;\n}\n.pub-block[data-v-f9dfd950] {\n    flex: 1;\n    height: 100%;\n    background: #000;\n    border-top: 5px solid #fff;\n    border-left: 5px solid #fff;\n    border-bottom: 5px solid #fff;\n    box-sizing: border-box;\n}\n.title[data-v-f9dfd950] {\n    text-align: center;\n}\nh1[data-v-f9dfd950] {\n    font-weight: 300;\n    font-family: \"Metric\", Helvetica, Arial, sans-serif;\n    line-height: .8em;\n    letter-spacing: -0.02em;\n}\n.k-button[data-v-f9dfd950], .status[data-v-f9dfd950] {\n    margin-top: 10px;\n}\n.invalid[data-v-f9dfd950] {\n    color: red;\n}\n.valid[data-v-f9dfd950] {\n    color: green;\n}\n.ticketsForm[data-v-f9dfd950] {\n    margin: 0 10px;\n    display: flex;\n    flex-direction: column;\n}\n.ticketsForm  > div[data-v-f9dfd950] {\n    align-self: center;\n    width: 70%;\n    margin-top: 15px;\n}\n.ticketsForm  input[data-v-f9dfd950] {\n    margin-top: 5px;\n    width: 100%;\n}\n.licence[data-v-f9dfd950] {\n    font-size: .8em;\n    color: rgba(0, 0, 0, .8)\n}\n.licence a[data-v-f9dfd950] {\n    color: #000;\n    outline: none;\n}\n@-webkit-keyframes spin-data-v-f9dfd950 {\nfrom { -webkit-transform: rotate(0deg);\n}\nto { -webkit-transform: rotate(360deg);\n}\n}\n@keyframes spin-data-v-f9dfd950 {\nfrom {-webkit-transform:rotate(0deg);transform:rotate(0deg);}\nto {-webkit-transform:rotate(360deg);transform:rotate(360deg);}\n}\n.k-icon.k-i-reload[data-v-f9dfd950] {\n    -webkit-animation: spin-data-v-f9dfd950 2s infinite linear;\n    animation: spin-data-v-f9dfd950 .6s infinite linear;\n}\n.error[data-v-f9dfd950] {\n    color: red;\n    margin: 0 5px 0 5px;\n}\n.tips[data-v-f9dfd950] {\n    width: 300px;\n    height: 350px;\n    left: 50%;\n    top: 50%;\n    margin-left: -150px;\n    margin-top: -150px;\n    position: absolute;\n    z-index: 2;\n}\n",""])},pyCd:function(t,e){}},[[0,1,2]]]);